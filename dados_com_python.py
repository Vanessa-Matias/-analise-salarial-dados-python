# -*- coding: utf-8 -*-
"""Dados com Python.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1BwffOOEvL2wxEp1bKM0JvewuDbcs2nby

# Projeto da Imers√£o Dados com Python - Alura
## Este projeto faz parte da Imers√£o de Dados com Python da Alura e tem como objetivo principal a an√°lise explorat√≥ria de um conjunto de dados de sal√°rios de profissionais da √°rea de dados.

## Aula 1: Introdu√ß√£o ao Pandas e Carga de Dados no Google Colab
Nesta aula vou carregar arquivos CSV no Google Colab e iniciar a an√°lise de dados com Pandas. Usando comandos simples, para come√ßar a manipular bases reais, preparando os dados para an√°lises mais profundas e identifica√ß√£o de padr√µes no mercado de trabalho.

### O que farei nesta aula?
* Aprender como carregar arquivos CSV no Google Colab de forma pr√°tica.
* Utilizar a biblioteca Pandas para leitura e visualiza√ß√£o inicial de dados.
* Manipular dados reais com os principais comandos de an√°lise.
"""

# Importando a biblioteca Pandas para a manipula√ß√£o de dados

import pandas as pd

# Carregando o Conjunto de Dados usando o arquivo CSV diretamente do GitHub usando a biblioteca Pandas.

df= pd.read_csv('https://raw.githubusercontent.com/guilhermeonrails/data-jobs/refs/heads/main/salaries.csv')

#Fazendo a primeira visualiza√ß√£o da base de dados
df.head()

#Exibindo informa√ß√µes gerais sobre o DataFrame, como tipos de dados e valores n√£o nulos
df.info()

#Agora vai exibir uma descri√ß√£o um pouco mais aprofundada sobre as informa√ß√µes dessa base de dados
df.describe()

#Exibindo o tamanho da base
df.shape

#imprimindo a quantidade de linhas e colunas
linhas, colunas = df.shape[0], df.shape[1]
print(f'O Data Frame tem', linhas, 'linhas' ' e', colunas, 'colunas')

# Checando o nome das colunas
df.columns

# Traduzindo o nome das colunas para portugu√™s
renomear_colunas = {
    'work_year': 'ano',
    'experience_level': 'senioridade',
    'employment_type': 'contrato',
    'job_title': 'cargo',
    'salary': 'salario',
    'salary_currency': 'moeda',
    'salary_in_usd': 'usd',
    'employee_residence': 'residencia',
    'remote_ratio': 'remoto',
    'company_location': 'empresa',
    'company_size': 'tamanho_empresa'
}

# Aplicando a tradu√ß√£o dos nomes das colunas no DataFrame
df.rename(columns=renomear_colunas, inplace=True)

#mostrando as colunas
df.columns

# Contando a frequ√™ncia de cada n√≠vel de experi√™ncia na base de dados
df['senioridade'].value_counts()

# Contando a frequ√™ncia de cada tipo de contrato (emprego)
df[('contrato')].value_counts()

#  Contando a frequ√™ncia de cada modalidade de trabalho
# 0 = presencial, 50 = h√≠brido e 100 = remoto
df[('remoto')].value_counts()

# An√°lisando o tamanho da empresa
df[('tamanho_empresa')].value_counts()

# Mapeamento dos valores abreviados para os nomes completos em portugu√™s
traducao_senioridade = {
    'SE': 'Senior',
    'MI': 'Pleno',
    'EN': 'Junior',
    'EX': 'Executivo'
}

# Aplicando a tradu√ß√£o na coluna 'senioridade'
df['senioridade'] = df['senioridade'].replace(traducao_senioridade)

# Verificando se a tradu√ß√£o foi aplicada com sucesso
df['senioridade'].value_counts()

# Mapeamento dos valores abreviados para os nomes completos na coluna 'contrato'
traducao_contrato = {
    'FT': 'Tempo Integral',
    'PT': 'Meio Per√≠odo',
    'FL': 'Freelancer',
    'CT': 'Contrato'

}

# Aplicando a tradu√ß√£o na coluna 'contrato'
df['contrato'] = df['contrato'].replace(traducao_contrato)

# Verificando se a tradu√ß√£o foi aplicada com sucesso
df['contrato'].value_counts()

# Mapeamento dos valores abreviados para os nomes completos na coluna 'tamanho_empresa'
traducao_tamanho = {
    'S': 'Pequena',
    'M': 'M√©dia',
    'L': 'Grande'
}

# Aplicando a tradu√ß√£o na coluna 'tamanho_empresa'
df['tamanho_empresa'] = df['tamanho_empresa'].replace(traducao_tamanho)

# Verificando se a tradu√ß√£o foi aplicada com sucesso
df['tamanho_empresa'].value_counts()

# Mapeamento dos valores num√©ricos para os nomes completos na coluna 'remoto'
traducao_remoto = {
    0: 'Presencial',
    50: 'H√≠brido',
    100: 'Remoto'
}

# Aplicando a tradu√ß√£o na coluna 'remoto'
df['remoto'] = df['remoto'].replace(traducao_remoto)

# Verificando se a tradu√ß√£o foi aplicada com sucesso
df['remoto'].value_counts()

# Exibindo as primeiras 5 linhas do DataFrame atualizado
df.head()

# Exibindo estat√≠sticas descritivas para as colunas categ√≥ricas (texto)
df.describe(include='object')

"""## Aula 2: Tratamento de Dados e An√°lise Estruturada

### O que ter√° nessa aula?
Nesta aula, vou tratar dados de forma mais estruturada, preparando a base para an√°lises mais assertivas. O foco est√° em identificar e lidar com dados faltantes, organizar colunas, aplicar filtros e gerar estat√≠sticas descritivas que ajudam a entender melhor os dados e extrair insights relevantes.

### O que farei nesta aula?
* Aprender t√©cnicas para renomear colunas de maneira clara e organizada.
* Identificar e tratar dados faltantes em bases reais.
* Aplicar filtros simples para selecionar informa√ß√µes relevantes.
* Gerar estat√≠sticas descritivas que apoiam a an√°lise e tomada de decis√£o.
"""

# Verificando a presen√ßa de valores nulos no DataFrame
df.isnull()

df.head()

# Contando a quantidade de valores nulos por coluna
df.isnull().sum()

# Listando todos os anos √∫nicos presentes no DataFrame
df[('ano')].unique()

# Exibindo as linhas que cont√™m valores nulos
df[df.isnull().any(axis=1)]

"""### Demonstra√ß√£o: Tratando Dados Faltantes em Colunas Num√©ricas e de Texto. Esta op√ß√£o √© um pouco mais detalhada, explicando que voc√™ est√° mostrando como o fillna() funciona para diferentes tipos de dados."""

# Importando a biblioteca numpy para lidar com valores nulos (np.nan)
import numpy as np

# Criando um DataFrame de exemplo para demonstra√ß√£o
df_salarios = pd.DataFrame ({
    'nome':  ['Ana', 'Vanessa', 'Joao', 'Carla', 'Val'],
    'salario': [4000, np.nan, 5000, np.nan, 100000 ]
})

'''Preenchendo os valores nulos da coluna 'salario' com a m√©dia dos sal√°rios
O .mean() calcula a m√©dia dos sal√°rios e o .round(2) arredonda o valor'''
df_salarios['salario_media'] = df_salarios['salario'].fillna(df_salarios['salario'].mean().round(2))

'''Preenchendo os valores nulos da coluna 'salario' com a mediana
 A mediana √© o valor do meio e √© menos sens√≠vel a outliers (valores extremos)'''
df_salarios['salario_mediana'] = df_salarios['salario'].fillna(df_salarios['salario'].median())

# Visualizando o DataFrame para ver o resultado
df_salarios

# Criando um DataFrame de exemplo com dados de cidades
df_cidades = pd.DataFrame ({
    'nome':  ['Ana', 'Vanessa', 'Joao', 'Carla', 'Val'],
    'cidades': ['S√£o Paulo', np.nan, 'Curitiba', np.nan, 'Bel√©m']
})

'''Preenchendo os valores nulos da coluna 'cidades' com a string 'N√£o informado.
Essa √© uma forma comum de tratar dados faltantes em colunas de texto'''
df_cidades['cidade_preenchida'] = df_cidades['cidades'].fillna('N√£o informado')

# Exibindo o DataFrame para ver o resultado
df_cidades

"""###Continuando a An√°lise na Base de Dados Limpa"""

# Removendo todas as linhas que cont√™m valores nulos
df_limpos = df.dropna()

# Verificando se restaram valores nulos no novo DataFrame
df_limpos.isnull().sum()

# Visualizando as primeiras linhas do DataFrame limpo
df_limpos.head()

# Informa√ß√µes da base
df_limpos.info()

# Convertendo o tipo de dado da coluna 'ano' de float (ex: 2025.0) para inteiro (ex: 2025)
df_limpos = df_limpos.assign(ano = df_limpos['ano'].astype('int64'))

"""## Aula 3: Criando Gr√°ficos

### O que ter√° nessa aula?
Nesta aula, vou criar gr√°ficos para visualizar e explorar informa√ß√µes presentes nos dados. Tamb√©m vou explorar diferentes tipos de gr√°ficos estat√≠sticos como: histogramas, boxplots e gr√°ficos de barras. Esse passo √© importante para identificar padr√µes, facilitar a interpreta√ß√£o e comunicar os resultados de forma mais clara.

### O que farei nessa aula?
* Criar gr√°ficos estat√≠sticos para analisar os dados de forma visual.
* Construir histogramas para observar a distribui√ß√£o das informa√ß√µes.
* Utilizar bibliotecas de Python que ajudam na cria√ß√£o de gr√°ficos.
* Praticar a visualiza√ß√£o de dados para apoiar a an√°lise e tomada de decis√µes.
"""

# Checando as primeiras linhas dos dados
df_limpos.head()

# Contagem e visualiza√ß√£o da frequ√™ncia de cada n√≠vel de senioridade
df_limpos['senioridade'].value_counts().plot(kind='bar',title='Distribui√ß√£o de Senioridade')

# Importando a biblioteca Seaborn para visualiza√ß√£o de dados estat√≠sticos
import seaborn as sns

# Gr√°fico de barras para visualizar a m√©dia salarial por n√≠vel de senioridade
sns.barplot(data=df_limpos,x='senioridade',y='usd')

#Exibindo o gr√°fico
plt.show()

# Importando a biblioteca Matplotlib para criar visualiza√ß√µes
import matplotlib.pyplot as plt

# Definindo tamanho da figura (largura, altura)
plt.figure(figsize=(8, 5))

# Gr√°fico de barras para visualizar a m√©dia salarial por n√≠vel de senioridade
sns.barplot(data=df_limpos,x='senioridade',y='usd')

# Definindo o t√≠tulo do gr√°fico
plt.title('S√°lario m√©dio por senioridade')

# Definindo o r√≥tulo do eixo X
plt.xlabel('Senioridade')

# Definindo o r√≥tulo do eixo Y
plt.ylabel('Sal√°rio m√©dio anual em (USD)')

# Exibindo o gr√°fico
plt.show()

# Calculando a m√©dia salarial por n√≠vel de senioridade e ordenando os resultados
df_limpos.groupby('senioridade')['usd'].mean().sort_values(ascending=False)

# Definindo a ordem das categorias de senioridade com base no sal√°rio m√©dio (do maior para o menor)
ordem = df_limpos.groupby('senioridade')['usd'].mean().sort_values(ascending=False).index

# Exibindo
ordem

# Definindo tamanho da figura (largura, altura)
plt.figure(figsize=(8, 5))

'''Gr√°fico de barras para visualizar a m√©dia salarial por n√≠vel de senioridade.
O par√¢metro 'order' foi adicionado para exibir os dados em uma ordem espec√≠fica'''
sns.barplot(data=df_limpos,x='senioridade',y='usd', order=ordem)

# Definindo o t√≠tulo do gr√°fico
plt.title('S√°lario m√©dio por senioridade')

# Definindo o r√≥tulo do eixo X
plt.xlabel('Senioridade')

# Definindo o r√≥tulo do eixo Y
plt.ylabel('Sal√°rio m√©dio anual em (USD)')

# Exibindo o gr√°fico
plt.show()

# Definindo tamanho da figura (largura, altura)
plt.figure(figsize=(10, 5))

# Gr√°fico de histograma para visualizar a distribui√ß√£o salarial dos funcion√°rios
sns.histplot(df_limpos['usd'], bins = 50, kde=True)

# Definindo o t√≠tulo do gr√°fico
plt.title('Distribui√ß√£o dos sal√°rios anuais dos funcion√°rios')

# Definindo o r√≥tulo do eixo X
plt.xlabel('Sal√°rio em (USD)')

# Definindo o r√≥tulo do eixo Y
plt.ylabel('Frequ√™ncia')

# Exibindo o gr√°fico
plt.show()

# Definindo tamanho da figura (largura, altura)
plt.figure(figsize=(8, 5))

# Gr√°fico de boxplot para visualizar a distribui√ß√£o salarial dos funcion√°rios
# O boxplot √© √∫til para identificar a mediana, quartis e outliers (sal√°rios extremos)
sns.boxplot(x=df_limpos['usd'])

#Titulo do gr√°fico
plt.title('Boxplot sal√°rios')

# Definindo o r√≥tulo do eixo X
plt.xlabel('Sal√°rio em (USD)')

# Exibindo o gr√°fico
plt.show()

# Definindo a ordem das categorias de senioridade para o gr√°fico
ordem_senioridade = ['Junior', 'Pleno', 'Senior', 'Executivo']

# Definindo tamanho da figura (largura, altura)
plt.figure(figsize=(8, 5))

''' Criando um boxplot para comparar a distribui√ß√£o salarial por n√≠vel de senioridade.
O par√¢metro 'order' garante que a ordem das categorias seja a definida acima'''
sns.boxplot(x='senioridade', y='usd', data=df_limpos, order=ordem_senioridade)

#
plt.title('Boxplot da distribui√ß√£o por senioridade')

# Definindo o r√≥tulo do eixo X
plt.xlabel('Sal√°rio em USD')

# Exibindo o gr√°fico
plt.show()

# Definindo a ordem das categorias de senioridade para o gr√°fico
ordem_senioridade = ['Junior', 'Pleno', 'Senior', 'Executivo']

# Definindo tamanho da figura (largura, altura)
plt.figure(figsize=(8, 5))

''' Criando um boxplot para comparar a distribui√ß√£o salarial por n√≠vel de senioridade.
O par√¢metro 'order' garante que a ordem das categorias seja a definida acima.
Adicionando cores distintas para cada n√≠vel de senioridade usando 'palette' e 'hue' '''
sns.boxplot(x='senioridade', y='usd', data=df_limpos, order=ordem_senioridade, palette='Set2',hue='senioridade')

#
plt.title('Boxplot da distribui√ß√£o por senioridade')

# Definindo o r√≥tulo do eixo X
plt.xlabel('Sal√°rio em USD')

# Exibindo o gr√°fico
plt.show()

# Importando a biblioteca Plotly Express para criar gr√°ficos interativos
import plotly.express as px

# Calculando a m√©dia salarial por senioridade, ordenando os resultados de forma decrescente e resetando o √≠ndice para usar no gr√°fico
senioridade_media_salarial = df_limpos.groupby('senioridade')['usd'].mean().sort_values(ascending=False).reset_index()

# Criando um gr√°fico de barras interativo com o Plotly
fig = px.bar(senioridade_media_salarial,
             x='senioridade',
             y='usd',
             title='M√©dia salarial por senioridade',
             labels={'senioridade': 'N√≠vel de Senioridade', 'usd': 'M√©dia Salarial anual(USD)'})

# Exibindo o gr√°fico
fig.show()

#Contando a frequ√™ncia de cada tipo de trabalho ('remoto', 'h√≠brido', 'presencial')
remoto_contagem = df_limpos['remoto'].value_counts().reset_index()

# Renomeando as colunas do DataFrame para 'tipo_trabalho' e 'quantidade'
remoto_contagem.columns = ['tipo_trabalho', 'quantidade']

# Criando um gr√°fico de pizza com Plotly Express
fig = px.pie(remoto_contagem,
             names='tipo_trabalho',
             values='quantidade',
             title='propor√ß√£o do tipo de trabalho'

             )

# Exibindo o gr√°fico
fig.show()

#Contando a frequ√™ncia de cada tipo de trabalho ('remoto', 'h√≠brido', 'presencial')
remoto_contagem = df_limpos['remoto'].value_counts().reset_index()

# Renomeando as colunas do DataFrame para 'tipo_trabalho' e 'quantidade'
remoto_contagem.columns = ['tipo_trabalho', 'quantidade']

# Criando um gr√°fico de rosca com Plotly Express
fig = px.pie(remoto_contagem,
             names='tipo_trabalho',
             values='quantidade',
             title='propor√ß√£o do tipo de trabalho',
             hole=0.5

             )
# Exibindo a porcentagem r√≥tulo
fig.update_traces(textinfo='percent+label')

# Exibindo o gr√°fico
fig.show()

# Mapeia os c√≥digos de pa√≠s para os nomes completos.
pip install pycountry

# importando essa biblioteca, garante que a visualiza√ß√£o no dashboard seja mais clara e f√°cil de entender.
import pycountry

# --- Visualiza√ß√£o de Sal√°rios no Mapa ---

# Fun√ß√£o para converter o c√≥digo do pa√≠s de 2 para 3 letras (ISO-2 para ISO-3)
def iso2_to_iso3(code):
  try:
    return pycountry.countries.get(alpha_2=code).alpha_3
  except AttributeError:
    return None

# Aplica a fun√ß√£o para criar uma nova coluna com o c√≥digo ISO-3
df_limpos['residencia_iso3'] = df_limpos['residencia'].apply(iso2_to_iso3)

# Filtra o DataFrame para pegar apenas os registros de 'Data Scientist'
df_ds = df_limpos[df_limpos['cargo'] == 'Data Scientist']

#Agrupa por pa√≠s e calcula a m√©dia salarial para o mapa
media_ds_pais = df_ds.groupby('residencia_iso3')['usd'].mean().reset_index()

# Cria o mapa coropl√©tico com Plotly Express
fig = px.choropleth(media_ds_pais,
        locations='residencia_iso3',
        color='usd',
        color_continuous_scale='rdylgn',
        title='Sal√°rio m√©dio de Ci√™ntista de Dados por Pa√≠s',
        labels={'usd': 'Sal√°rio m√©dio (USD)', 'residencia_iso3': 'Pa√≠s'}
    )

# Exibir o mapa
fig.show()

# Exibir 5 primeiras linhas
df_limpos.head()

'''Salvar o DataFrame df_limpos em um novo arquivo CSV.
index=False: Este √© um par√¢metro crucial. Ele informa ao Pandas para n√£o salvar o √≠ndice do DataFrame como uma coluna no arquivo CSV.'''
df_limpos.to_csv('dados-imersao-final.csv', index=False)

"""# Aula 4 - Construindo Dashboard Interativo

### O que ter√° nessa aula?
Nesta aula, ter√° a biblioteca Streamlit e aprender a criar um dashboard interativo de forma pr√°tica. Com ele, ser√° poss√≠vel visualizar dados, aplicar filtros e gerar gr√°ficos em tempo real, facilitando a an√°lise e a apresenta√ß√£o das informa√ß√µes.

### O que farei nessa aula?
* Conhecer a biblioteca Streamlit para criar dashboards interativos.
* Desenvolver interfaces simples para visualiza√ß√£o de dados.
* Aplicar filtros din√¢micos para explorar os dados em tempo real.
* Gerar gr√°ficos direto no dashboard para facilitar a an√°lise.

### Observa√ß√£o: A partir daqui, este c√≥digo foi desenvolvido para ser executado no VS Code, usando o ambiente virtual configurado com as bibliotecas instaladas. A etapa de constru√ß√£o e execu√ß√£o do aplicativo Streamlit ser√° feita diretamente no VS Code, mas tamb√©m deixarei o c√≥digo disponiv√©l aqui.

"""

# Importando as bibliotecas essenciais para o projeto de an√°lise de dados.
''' A biblioteca Streamlit √© usada para criar dashboards e aplicativos web.Pandas √© a principal biblioteca para manipula√ß√£o e an√°lise de dados tabulares.
Plotly Express √© uma parte da biblioteca Plotly que simplifica a cria√ß√£o de gr√°ficos interativos e visualiza√ß√µes de dados interativos'''
import streamlit as st
import pandas as pd
import plotly.express as px

#Configura√ß√£o da P√°gina

# Define configura√ß√µes b√°sicas da p√°gina, deve ser a primeira chamada do script.
st.set_page_config(
    page_title="Dashboard de Sal√°rios na √Årea de Dados", # T√≠tulo que aparece na aba do navegador.
    page_icon="üìä", # √çcone da aba do navegador (emoji).
    layout="wide", # Layout da p√°gina: 'wide' usa a largura total da tela.
)

#Carregamento dos dados
df = pd.read_csv("https://raw.githubusercontent.com/vqrca/dashboard_salarios_dados/refs/heads/main/dados-imersao-final.csv")

#-- Barra Lateral (Filtros)--
st.sidebar.header("üîç Filtros")

#Filtro de Ano
anos_disponiveis = sorted(df['ano'].unique())
anos_selecionados = st.sidebar.multiselect("Ano", anos_disponiveis, default=anos_disponiveis)

#Filtro de Senioridade
senioridades_disponiveis = sorted(df['senioridade'].unique())
senioridades_selecionadas = st.sidebar.multiselect("Senioridade", senioridades_disponiveis, default=senioridades_disponiveis)

#Filtro por Tipo de Contrato
contratos_disponiveis = sorted(df['contrato'].unique())
contratos_selecionados = st.sidebar.multiselect("Tipo de Contrato", contratos_disponiveis, default=contratos_disponiveis)

#Filtro por Tamanho da Empresa
tamanhos_disponiveis = sorted(df['tamanho_empresa'].unique())
tamanhos_selecionados = st.sidebar.multiselect("Tamanho da Empresa", tamanhos_disponiveis, default=tamanhos_disponiveis)

# --- Filtragem do DataFrame ---
#O dataframe principal √© filtrado com base nas sele√ß√µes feitas na barra lateral.
df_filtrado = df[
    (df['ano'].isin(anos_selecionados)) &
    (df['senioridade'].isin(senioridades_selecionadas)) &
    (df['contrato'].isin(contratos_selecionados)) &
    (df['tamanho_empresa'].isin(tamanhos_selecionados))
]

# --- Conte√∫do Principal ---
st.title("üé≤ Dashboard de An√°lise de Sal√°rios na √Årea de Dados")
st.markdown("Explore os dados salariais na √°rea de dados nos √∫ltimos anos. Utilize os filtros √† esquerda para refinar sua an√°lise.")

# --- M√©tricas Principais (KPIs) ---
st.subheader("M√©tricas gerais (Sal√°rio anual em USD)") #Esta linha cria um t√≠tulo de n√≠vel 2
if not df_filtrado.empty:
    salario_medio = df_filtrado['usd'].mean()
    salario_maximo = df_filtrado['usd'].max()
    total_registros = df_filtrado.shape[0]
    cargo_mais_frequente = df_filtrado["cargo"].mode()[0]
else:
    salario_medio, salario_mediano, salario_maximo, total_registros, cargo_mais_comum = 0, 0, 0, ""

col1, col2, col3, col4 = st.columns(4) #Esta linha cria quatro colunas no seu dashboard
col1.metric("Sal√°rio m√©dio", f"${salario_medio:,.0f}")
col2.metric("Sal√°rio m√°ximo", f"${salario_maximo:,.0f}")
col3.metric("Total de registros", f"{total_registros:,}")
col4.metric("Cargo mais frequente", cargo_mais_frequente)

st.markdown("---") #Esta linha adiciona uma linha horizontal

# --- An√°lises Visuais com Plotly ---
st.subheader("Gr√°ficos")

# Cria duas colunas para os dois primeiros gr√°ficos
col_graf1, col_graf2 = st.columns(2)

# Bloco do primeiro gr√°fico (barra horizontal)
with col_graf1:
    # Verifica se h√° dados para evitar erros
    if not df_filtrado.empty:
        # Prepara os dados: calcula a m√©dia salarial para os 10 cargos mais altos
        top_cargos = df_filtrado.groupby('cargo')['usd'].mean().nlargest(10).sort_values(ascending=True).reset_index()

        # Cria o gr√°fico de barras com Plotly Express
        grafico_cargos = px.bar(
            top_cargos,
            x='usd', y='cargo',
            orientation='h',
            title="Top 10 cargos por sal√°rio m√©dio",
            labels={'usd': 'M√©dia salarial anual (USD)', 'cargo': ''}
        )

        # Ajusta o layout do gr√°fico
        grafico_cargos.update_layout(title_x=0.1, yaxis={'categoryorder':'total ascending'})

        # Exibe o gr√°fico no Streamlit
        st.plotly_chart(grafico_cargos, use_container_width=True)
    else:
        st.warning("Nenhum dado para exibir no gr√°fico de cargos.")

# Bloco do segundo gr√°fico (histograma)
with col_graf2:
    if not df_filtrado.empty:
        # Cria um histograma para mostrar a distribui√ß√£o dos sal√°rios
        grafico_hist = px.histogram(
            df_filtrado,
            x='usd',
            nbins=30,
            title="Distribui√ß√£o de sal√°rios anuais",
            labels={'usd': 'Faixa salarial (USD)', 'count': ''}
        )
        # Ajusta o layout do gr√°fico
        grafico_hist.update_layout(title_x=0.1)
        # Exibe o gr√°fico no Streamlit
        st.plotly_chart(grafico_hist, use_container_width=True)
    else:
        st.warning("Nenhum dado para exibir no gr√°fico de distribui√ß√£o.")

# Cria uma nova linha com duas colunas para o terceiro gr√°fico (e uma vazia)
col_graf3, col_graf4 = st.columns(2)

# Bloco do terceiro gr√°fico (pizza/rosca)
with col_graf3:
    if not df_filtrado.empty:
        # Prepara os dados: conta a quantidade de cada tipo de trabalho (remoto ou n√£o)
        remoto_contagem = df_filtrado['remoto'].value_counts().reset_index()
        remoto_contagem.columns = ['tipo_trabalho', 'quantidade']

        # Cria o gr√°fico de pizza (rosca) com Plotly
        grafico_remoto = px.pie(
            remoto_contagem,
            names='tipo_trabalho',
            values='quantidade',
            title='Propor√ß√£o dos tipos de trabalho',
            hole=0.5  # Cria um gr√°fico de rosca
        )
        # Formata o texto do gr√°fico para mostrar a porcentagem
        grafico_remoto.update_traces(textinfo='percent+label')
        # Ajusta o layout do gr√°fico
        grafico_remoto.update_layout(title_x=0.1)
        # Exibe o gr√°fico no Streamlit
        st.plotly_chart(grafico_remoto, use_container_width=True)
    else:
        st.warning("Nenhum dado para exibir no gr√°fico dos tipos de trabalho.")

        # Bloco do gr√°fico 4 (mapa de sal√°rios)
with col_graf4:
    if not df_filtrado.empty:
        # Filtra o DataFrame para criar um mapa apenas para Cientistas de Dados
        df_ds = df_filtrado[df_filtrado['cargo'] == 'Data Scientist']

        # Calcula a m√©dia salarial de Cientistas de Dados por pa√≠s
        media_ds_pais = df_ds.groupby('residencia_iso3')['usd'].mean().reset_index()

        # Cria o mapa coropl√©tico com o Plotly
        grafico_paises = px.choropleth(media_ds_pais,
            locations='residencia_iso3',
            color='usd',
            color_continuous_scale='rdylgn',
            title='Sal√°rio m√©dio de Cientista de Dados por pa√≠s',
            labels={'usd': 'Sal√°rio m√©dio (USD)', 'residencia_iso3': 'Pa√≠s'})

        # Ajusta a posi√ß√£o do t√≠tulo do mapa
        grafico_paises.update_layout(title_x=0.1)

        # Exibe o mapa no Streamlit
        st.plotly_chart(grafico_paises, use_container_width=True)
    else:
        st.warning("Nenhum dado para exibir no gr√°fico de pa√≠ses.")

# --- Tabela de Dados Detalhados ---
st.subheader("Dados Detalhados")
# Exibe o DataFrame filtrado como uma tabela interativa no dashboard
st.dataframe(df_filtrado)

!pip install streamlit